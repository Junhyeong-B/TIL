# 14장 전역변수의 문제점

1. 변수 선언은 선언문이 어디에 있든 상관 없이 가장 먼저 실행된다.
    - 위 내용은 전역 변수에 한정된다.
    - **전역 변수 선언**은 코드가 한 줄씩 순차적으로 실행되는 시점인 런타임에 실행되는 것이 아니라 **런타임 이전 단계에서 자바스크립트 엔진에 의해 먼저 실행**된다.

<br />

2. 지역 변수의 생명 주기는 함수의 생명 주기와 일치한다.
    - 함수 몸체 내부에서 선언된 지역 변수의 생명 주기는 함수의 생명 주기와 대부분 일치하지만 **지역 변수가 함수보다 오래 생존하는 경우도 있다**.

```jsx
function a() {
                    // 변수 x 생성
	var x = 10;       // 변수 x에 값 할당
	console.log(x);
	return x;         // 변수 x 소멸
}
```

<br />

3. 변수는 자신이 등록된 **스코프가 소멸(메모리 해제)**될 때까지 유효하다.
    - 변수 선언으로 할당된 메모리 공간은 더 이상 그 누구도 참조하지 않을 때 가비지 콜렉터에 의해 해제되어 가용 메모리 풀에 반환된다.

<br />

4. **호이스팅**은 스코프 단위로 동작하는데, 변수 선언이 스코프의 선두로 끌어 올려진 것처럼 동작하는 자바스크립트 고유의 특징이다.

<br />

5. **전역 변수**는 명시적인 호출 없이 코드가 로드되자마자 곧바로 해석되고 실행된다.

<br />

6. var 키워드로 선언한 전역 변수는 전역 **객체의 프로퍼티**가 된다. 브라우저 환경에서는 전역 객체인 **window** 객체의 프로퍼티가 되는 것이다.
    
    따라서, var 키워드로 선언한 전역 변수는 웹 페이지를 닫기 전까지 유효하다.(**var 키워드로 선언한 전역 변수의 생명 주기는 전역 객체의 생명 주기와 일치한다.**)
    

<br />

7. 모든 코드가 전역 변수를 참조하고 변경할 수 있는 것을 **암묵적 결합(implicit coupling)**이라고 한다.

<br />

8. 변수의 **유효 범위가 클수록** 코드의 **가독성은 나빠지고** 의도치 않게 상태가 변경될 수 있는 **위험성은 높아진다.**

<br />

### 전역 변수의 단점

1) 생명 주기가 길다. 

⇒ 메모리 소스도 오랜 기간 소비한다.

<br />

2) 전역 변수는 스코프 체인 상 종점에 위치하므로 검색 속도가 가장 느리다.

<br />

3) 파일이 분리되어 있어도 동일한 이름으로 명명된 전역 변수나 함수가 같은 스코프 내에 있다면 예상치 못한 결과가 발생한다.

<br />

### 전역 변수의 사용을 억제하는 방법

- 반드시 전역 변수를 사용해야 하는 것이 아니라면 지역 변수를 사용해야 하고, 변수의 스코프는 좁을 수록 좋다.

1) 즉시 실행 함수

⇒ 모든 코드를 즉시 실행 함수로 감싸면 모든 변수는 즉시 실행 함수의 지역 변수가 된다.

```jsx
(function () {
	var a = 100;
}());
console.log(a); // ReferenceError: a is not defined
```

<br />

2) 네임스페이스 역할을 담당할 **객체를 생성**하고 전역 변수로 사용하고 싶은 **변수를 프로퍼티로 추가**한다.

<br />

3) 모듈 패턴: 클로저를 기반으로 동작한다.

```jsx
var Counter = (function () {
	var num = 0; // private 변수

	return { // 외부로 공개할 데이터나 메서드를 프로퍼티로 추가한 객체를 반환한다.
		increase() {
			return ++num;
		},
		decrease() {
			return --num;
		}
	}
}());

console.log(num); // undefined
console.log(Counter.increase()); // 1
console.log(Counter.increase()); // 2
console.log(Counter.decrease()); // 1
```

<br />

4) ES6 모듈을 사용한다.

⇒ ES6 모듈은 파일 자체에 독자적인 모듈 스코프를 제공하며 script 태그에 `type="module"` 어트리뷰트를 추가하면 자바스크립트 파일은 모듈로서 동작한다.

<br />

# 🤔 문제

1. 함수 몸체 내부에서 선언된 지역 변수의 생명 주기는 함수의 생명 주기와 대부분 일치하지만 지역 변수가 함수보다 오래 생존하는 경우도 있다.
    
    (⭕) or (❌)
    
<br />

- 답
  
  ⭕

<br />
       

2. 전역 변수의 특징이 아닌 것은?
    1. 모든 코드가 전역 변수를 변경할 수 있지만 의도치 않게 변경되지 않도록 은닉(information hiding)할 수 있다.
    2. 메모리 리소스를 오랜 시간 소비한다.
    3. 스코프 체인 상 종점에 존재해서 탐색 시간이 오래 걸린다.
    4. 즉시 실행 함수에 외부에 노출하고 싶은 객체를 반환하면 객체의 프로퍼티는 외부에서 접근할 수 없는 프라이빗 멤버(private member)가 된다.
   
<br />

- 답
  
  d.
  
  객체의 프로퍼티는 외부에 노출되는 **퍼블릭 멤버(public member)**이고, 반환하는 객체에 추가하지 않는 변수나 함수를 **프라이빗 멤버**라고 한다.