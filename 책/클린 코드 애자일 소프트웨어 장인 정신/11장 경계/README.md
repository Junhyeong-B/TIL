# 11장 시스템

# 1. 도시를 세운다면?

- 도시에서 이루어지는 수도, 전력, 교통, 치안, 건축물 등을 혼자서 관리하는 것은 불가능할 것이다.
- 그러나 실제 도시는 잘 돌아가는데, 각각의 분야를 관리하는 팀으로 나누어져 있기 때문이다.
- 소프트웨어 팀도 관심사를 분리하거나 추상화를 이뤄내어 시스템을 갖추는 것이 필요하다.

<br />

# 2. 시스템 제작과 시스템 사용의 분리

- 제작(construction)과 사용(use)은 다르다.
- 소프트웨어 시스템은 준비 과정과 런타임 로직을 분리해야 한다.
- 시작 단계에서는 관심사(concern)을 분리해야 한다.

<br />

### 2-1) Main 분리

- 생성과 관련한 코드는 모두 main이나 main이 호출하는 모듈로 옮기고, 나머지 시스템은 모든 객체가 생성되었고 모든 의존성이 연결되었다고 가정한다.
- 어플리케이션은 main이나 객체가 생성되는 과정을 전혀 모른다.
- 모든 객체가 적절히 생성되었다고 가정한다.

<div align="center">
    <img src="https://user-images.githubusercontent.com/85148549/168307603-af7ebb81-2390-4fbf-bc56-243241dcb5ce.png" />
</div>

<br />

### 2-2) 팩토리

- 객체가 생성되는 시점을 어플리케이션이 결정할 필요도 있다.
- 예를 들어, 주문처리 시스템에서는 LineItem을 어플리케이션이 생성하여 Order에 추가한다면 아이템을 생성하는 시점은 어플리케이션이 결정하고, 생성하는 코드는 어플리케이션이 모른다.
- 모든 의존성은 main에서 OrderProcessing을 통해 어플리케이션으로 향한다.

<div align="center">
    <img src="https://user-images.githubusercontent.com/85148549/168307614-a8def718-43cd-4158-b49d-8231f56e7550.png" />
</div>

<br />

### 2-3) 의존성 주입

- 사용과 제작을 분리하는 메커니즘으로, 제어 역전(Inversion of Control, IoC)기법을 적용한 메커니즘이다.
- 제어 역전에서는 한 객체가 맡은 보조 책임을 새로운 객체에게 전적으로 떠넘긴다.
- 새로운 객체는 넘겨받은 책임만 맡으므로 단일 책임 원칙(SRP)을 지키게 된다.

<br />

# 3. 확장

- 소프트웨어 팀은 성장함에 따라 시스템 확장이 필요하다.
- 그러나 처음부터 올바르게 시스템을 만들 수는 없다.
- 그러므로 새로운 스토리에 맞춰 시스템을 조정하고 확장하면 되는데, 이것이 애자일 방식의 핵심이다.
- 테스트 주도 개발(Test Driven Development, TDD), 리팩터링, 깨끗한 코드는 시세틈을 조정하고 확장하기 쉽게 만든다.
- 소프트웨어 시스템의 관심사를 적절히 분리한다면 점진적으로 발전할 수 있다.

<br />

# 4. 테스트 주도 시스템 아키텍처 구축

- 코드 수준에서 아키텍처 관심사를 분리할 수 있다면, 테스트 주도 아키텍처 구축이 가능해지고, 새로운 기술을 채택해 단순한 아키텍처를 복잡한 아키텍처로 키워갈 수 있다.

<br />

# 5. 의사 결정의 최적화

- 모듈을 나누고 관심사를 분리하면 지엽적인 관리와 결정이 가능해진다.
- 때때로 가능한 마지막 순간까지 결정을 미루는 방법이 최선일 수 있다.
    - 게으른 것이 아니라 최대한 정보를 모아 최선의 결정을 내리기 위해서다.
    - 너무 일찍 결정하면 고객 피드백, 프로젝트에 대한 고민, 구현 방안 등을 생각할 기회가 사라진다.

<br />

# 6. 명백한 가치가 있을 때 표준을 현명하게 사용하라

- 표준을 사용하면 아이디어와 컴포넌트를 재사용하기 쉽다.
- 좋은 아이디어를 캡슐화하기 쉽고, 컴포넌트를 엮기 쉽다.
- 다만, 표준을 만드는 시간이 오래 걸릴 수도 있다.

<br />

# 7. 시스템은 도메인 특화 언어가 필요하다.

- 도메인 특화 언어(Domain-Specific Language, DSL)를 사용하면 고차원 정책에서 저차원 세부사항에 이르기까지 모든 추상화 수준과 모든 도메인을 POJO로 표현할 수 있다.

<br />

# 8. 결론

- 시스템은 깨끗해야 한다.
- 깨끗하지 못하면 도메인 논리를 흐리거나 기민성을 떨어뜨리고, 이것은 제품 품질 하락으로 이어진다.
- 기민성이 떨어지면 생산성이 낮아져 TDD가 제공하는 장점이 사라진다.
- 시스템, 개별 모듈 등을 설계할 때 실제로 돌아가는 가장 단순한 수단을 사용해야 한다.