# 4장 주석

# 1. 주석은 나쁜 코드를 보완하지 못한다.

잘 달린 주석(좋은 주석)은 유용할 수 있다. 그러나 근거 없는 주석(나쁜 주석)은 코드를 이해하기 어렵게 만들거나, 잘못된 정보를 퍼뜨릴 가능성이 있다.

주석을 통해 코드의 의도를 전달하려고 한 것이라면 경우에 따라 다를 수는 있지만, 그것 자체로 코드의 짜임새가 좋지 못하다는 것을 증명한 셈이다.

책에서는 코드와 주석이 함께 작성된 것보다 애초에 주석이 필요 없는 방향으로 코드 작성에 에너지를 쏟는 쪽으로 노력해야 할 것이라고 표현한다.

<br />

# 2. 좋은 주석

좋은 주석이라고 표현하지만 어디까지나 주석 중 좋은 주석을 말하는 것이다. 가장 좋은 것은 주석이 없는데도 코드의 의미를 이해할 수 있는 간결하고 명확한 코드이다. 그럼에도 잘 작성된 주석은 있다.

<br />

### 2-1) 법적인 주석

소스 파일 첫머리에 계약 조건이나 법적인 정보, 표준 라이선스, 외부 문서 참조 등에 대한 내용을 작성한 것으로 법적인 이유로 특정 주석을 넣어야 할 때 사용한다.

```jsx
// Copyright (c) 2022 by Someone else, Inc. All rights reserved.
```

<br />

### 2-2) 정보 제공 주석

코드를 있는 그대로 해석하는 주석이 아닌 기본적인 정보를 제공하는 주석은 때때로 편리하다. 만약 정규표현식을 사용했고, 해당 정규표현식이 어떤 문자열을 매치하고 있는 것인지에 대한 내용을 주석에 표시한다면 더 쉽게 이해할 수 있을 것이다.

```jsx
// 'www.google.com'와 같은 url 형식이다. http, https 인지는 상관 없이 추출한다.
const expression = /[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)?/gi;
```

<br />

### 2-3) 의미를 명료하게 밝히는 주석

함수의 모호한 인수나 반환값은 그 의미를 읽기 좋게 표현하면 이해하기 쉬워진다.

```jsx
String.prototype.compareTo = function (str) {
	return this === str;
}

const pageA = "pageA";
const pageB = "pageB";
pageA.compareTo(pageB); // pageA === pageB
```

위 예제는 좋은 코드가 절대 아니라고 생각하지만, 말하려는 의도는 `2-3) 의미를 밝히는 주석`이 무엇인지 설명하기 위해 작성된 것이다.

> 여담으로 위 설명 자체가 주석이 안좋은 이유를 설명해준다고 생각한다.
>
> 코드 자체로 모든 의도를 설명할 수 있었다면 추가적인 정보는 필요 없었겠지만, 좋은 코드가 아니어서 오해가 생길 수 있는 부분을 설명해주기 위해 추가적인 내용을 덧붙였다.
> 

<br />

### 2-4) 결과를 경고하는 주석

다른 개발자에게 결과를 경고할 목적으로 주석을 사용할 수도 있다. 만약 테스트 코드를 작성했고, 해당 테스트를 수행하는 데에 오랜 시간이 걸린다면 이를 주석으로 알릴 수 있다.

```jsx
// 여유 시간이 충분하지 않다면 실행하지 마십시오.
function testWithBigFile() {
	for (let i = 0; i < 1000000; i++) {
		/* ... */
	}
}
```

<br />

### 2-5) TODO 주석

앞으로 할 일에 대해 TODO 주석으로 남겨 놓으면 나중에 알아보기 편하다. 내가 사용하는 VS Code는 확장 프로그램을 통해 `// TODO` 와 같이 주석을 남기면 해당 주석을 하이라이팅 해준다.

`// TODO` 주석은 코드를 설명하는 주석이 아니므로 해야할 일을 마무리 했다면 지우면 되고, 다른 개발자에게 잘못된 정보를 퍼뜨릴 가능성이 낮으며, IDE마다 다를 수는 있지만 TODO 주석을 찾기 수월하므로 유용하게 사용할 수 있다.

그렇다고 하더라도 TODO 주석이 다른 개발자가 봤을 때 그대로 둘 가능성이 높고, TODO 주석을 작성한 개발자가 해야할 일을 마무리 했지만 TODO 주석을 지우는 것을 깜빡했다면 코드를 더럽힐 수 있다. 책에서도 TODO 주석이 유용하게 쓰일 수는 있지만 없는 것이 더 낫다고 표현한다.

<br />

# 3. 나쁜 주석

위의 경우를 제외한 대부분의 경우가 나쁜 주석일 수 있다. 물론 위 좋은 주석에 작성된 내용에 해당하지 않으면서도 좋은 주석일 수 있는 것도 있을 것이다.

<br />

### 3-1) 같은 이야기를 중복하는 주석

간단한 함수나 변수에 대해 주석을 다는 것은 코드를 정당화 하지도, 의도나 근거를 설명하지도 못한다. 코드보다 부정확해 대충 이해하고 넘어가게 만들 수도 있다.

```jsx
// 컨테이너와 관련된 Loader 구현
const loader = null;
```

<br />

### 3-2) 오해할 여지가 있는 주석

만약 `// A변수가 true일 때 B를 반환한다. 시간을 초과하면 예외를 던진다.` 라는 주석이 작성되어 있다고 가정하자. 대부분의 개발자가 비슷하게 해석한다고 하더라도, A가 true로 변하는 순간에 B를 반환하는 것인지, A가 true여야 하는지, true가 아닌 경우 시간을 초과할 때까지 기다려야 하는지 다양한 오해를 일으킬 수 있는 가능성은 존재한다.

<br />

### 3-3) 이력이나 위치를 기록하는 주석

책에서 `예전`에는 모든 모듈 첫머리에 변경 이력을 기록하고 관리하는 관례가 바람직했다고 전달하고 있다. 여기서 `예전`이 얼마나 예전인지는 모르지만, 적어도 지금은 Git과 같은 분산 버전 관리 시스템(DVCS)으로 인해 변경 사항을 따로 작성하지 않고도 관리할 수 있다. 그래서 이력을 기록하는 주석은 불필요하다.

```jsx
// 22-04-10: B 메서드를 추가했다.
// 22-04-11: A 변수를 없애고 버그를 수정했다.
```

<br />

### 3-4) 주석으로 처리한 코드

코드를 수정하다 보면 기존의 코드를 주석처리하고 수정할 수도 있다. 그러나 주석으로 처리된 코드가 그대로 남아있다면 사용하지 않게된 코드가 되었다고 하더라도 다른 사람들이 지우기를 주저한다. 결국 오래 방치되고 아무런 정보도 주지 못하는 주석이 될 가능성이 높다.

이력을 남기기 위해서 일부로 남겨놓은 것도 문제다. 이미 버전 관리 시스템을 통해 코드 변경 이력을 관리할 수 있기 때문이다.

<br />

### 3-5) 전역 정보

주석을 달아야 한다면 근처에 있는(지역 정보) 코드에 대해서만 작성하는 것이 좋다. 코드 일부에 전역에 대한 정보를 적어 놓는다면 코드가 변하더라도 해당 주석이 변경되지도 않을 뿐더러 올바른 정보를 전달해주지도 못한다.

<br />

### 3-6) 모호한 관계

주석과 주석이 설명하는 코드는 관계가 명확해야 한다.

```jsx
// 필터 바이트를 더한 후 헤더 정보를 위해 200을 더한다.
this.pngBytes = ((this.width + 1) * (this.height * 3)) + 200;
```

위의 경우 필터 바이트가 의미하는 것이 `this.width + 1` 인지 `this.height * 3`인지 알 수 없다. 이런 주석은 주석 자체가 다시 설명을 요구하니 좋지 못하다.

<br />

# 4. 정리

대부분의 주석이 좋지 못한 이유는 코드가 업데이트될 때 주석까지 업데이트 해줘야 하며, 주석은 어플리케이션 실행에 영향을 주지 않기 때문에 무시하기 쉽다는 특성이 있어서라고 생각한다. 또한 본인이 작성한 주석이 아니라면 주석을 수정하거나 삭제하지 않을 가능성이 높고, 그대로 방치되다 올바르지 못한 정보를 전달하거나 주석이 너무 길어 코드보다 주석을 읽는 시간이 더 오래 걸릴 수도 있다.

처음 알고리즘 문제를 풀고, 코딩 테스트를 볼 때 그냥 푸는 것보다 코드의 설명이 담긴 주석을 같이 남겨주는 것이 좋다는 얘기를 익명의 누군가에게 전해 들었다. 한두사람이 얘기한 것이 아니었고, 꽤 많은 사람들이 자신은 알고리즘 문제 풀이에 주석까지 작성한다는 얘기를 했었다. 그래서 주석을 남기는 것이 항상 좋은 것인줄 잘못 알았고, 실제로 알고리즘 문제 풀이에 주석을 남겼을 때 가독성이 오히려 떨어지는 것을 스스로 느꼈지만 어쨌든 코드를 설명할 수 있으니 됐다고 안심하기도 했다.

지금은 주석이 아예 없는 코드가 좋은 코드라고 생각한다. 물론 주석이 없고, 의도를 이해할 수 없는 복잡한 코드라면 주석이 있는 것이 나을 수도 있지만 책에서 표현했듯 주석을 없애고 코드만으로 의도를 명확하게 만들기 위해 에너지를 쏟는 방향으로 작성하려고 노력할 것이다.